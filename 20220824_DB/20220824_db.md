



### ğŸŒ ì•„ì¹¨ ì¡°íšŒ ì‹œê°„ _ ëª¨ë¸ë§ ì‹¤ìŠµ 





![image-20220824095040654](20220824_db.assets/image-20220824095040654.png)

**ê°•ì˜ ë‹¤ì‹œë³´ê¸°ì™€ ê³¼ì œê°€ ì†ì„±ì¼ ë¿ì´ë‹¤.** 

![image-20220824095206858](20220824_db.assets/image-20220824095206858.png)

**ê³¼ì œì œì¶œë„ í•˜ë‚˜ì˜ ê³¼ì œì— ëŒ€í•´ ì—¬ëŸ¬ ì‚¬ìš©ìê°€ ê°ê° ì œì¶œí•œë‹¤ëŠ” ì ì„ ì°¸ê³ í•˜ê¸°** 

---



### âœ” ORM 

* íŒŒì´ì¬ìœ¼ë¡œ ë°ì´í„° ë² ì´ìŠ¤ë¥¼ ì¡°ì‘í•˜ëŠ” ê²ƒì´ë‹¤.  Object(ê°ì²´) Relational Mapping _ "**ê°ì²´ë¡œ DBë¥¼ ì¡°ì‘í•œë‹¤."** 

```sql
Genre.object.all()

-- ê²°ê³¼ëŠ”? : íŒŒì´ì¬ì—ì„œ ì‚¬ìš©í•  ìˆ˜ ìˆëŠ” ë°ì´í„° íƒ€ì…ìœ¼ë¡œ ë³€í˜•í•˜ì—¬ ë‚˜ì˜¨ë‹¤.
-- í´ë˜ìŠ¤ë¡œ ì •ì˜í•´ ë†“ê³  ì„¤ê³„ë¥¼ í•œë‹¤. 
```

* ê°ì²´ ì§€í–¥ í”„ë¡œê·¸ë˜ë° ì–¸ì–´ë¥¼ ì‚¬ìš©í•˜ì—¬ í˜¸í™˜ë˜ì§€ ì•ŠëŠ” ìœ í˜•ì˜ ì‹œìŠ¤í…œ ê°„ì˜ ë°ì´í„°ë¥¼ ë³€í™˜í•˜ëŠ” í”„ë¡œê·¸ë˜ë° ê¸°ìˆ  
* íŒŒì´ì¬ì—ì„œëŠ” SQLAchemy, peewee ë“± ë¼ì´ë¸ŒëŸ¬ë¦¬ê°€ ìˆìœ¼ë©° Django í”„ë ˆì„ ì›Œí¬ì—ì„œëŠ” ë‚´ì¥ Django ORM ì„ í™œìš©



### âœ” ëª¨ë¸ ì„¤ê³„ 

![image-20220824233243372](20220824_db.assets/image-20220824233243372.png)

**(1) í´ë˜ìŠ¤ë¥¼ ìƒì„±í•˜ì—¬ ë‚´ê°€ ì›í•˜ëŠ” DBì˜ êµ¬ì¡°ë¥¼ ë§Œë“ ë‹¤.** 

```python
import pastats
from django.db import models 

# Genre í´ë˜ìŠ¤ë¥¼ ë§Œë“œëŠ”ë°, mode-s.Mode ë‚´ë¶€ í´ë˜ìŠ¤ë¥¼ ìƒì†ë°›ëŠ”ë‹¤. 
# ì™œ ìƒì† ë°›ì„ ê¹Œìš”? ê¸°ëŠ¥ë“¤ì„ í™œìš©í•˜ê³  ì‹¶ì–´ì„œ _ ë¯¸ë¦¬ ë§Œë“¤ì–´ì§„ 

class Genre(models.model):
	name = models.charfield(max_length=30)
	
# varchar(30) 
# varchar ìœ í˜•ì€ ê°€ë³€ ê¸¸ì´ ì´ë¯€ë¡œ í•„ìš”í•œ ì˜ì—­ì€ ì‹¤ì œ ë°ì´í„° í¬ê¸°ë¿ì´ë‹¤. 
# char(s) : ê³ ì • ê¸¸ì´ ë¬¸ìì—´ ì •ë³´, s ë§Œí¼ ìµœëŒ€ ê¸¸ì´ë¥¼ ê°–ê³  ê³ ì • ê¸¸ì´ë¥¼ ê°€ì§€ê³  ìˆìœ¼ë¯€ë¡œ í• ë‹¹ëœ ë³€ìˆ˜ ê°’ì˜ ê¸¸ì´ê°€ së³´ë‹¤ ì‘ì„ ê²½ìš°ì—ëŠ” ê·¸ ì°¨ì´ ê¸¸ì´ë§Œí¼ ê³µê°„ìœ¼ë¡œ ì±„ì›Œì§„ë‹¤. 
# VARCHAR : CHARACTER VARYING ì˜ ì•½ìë¡œ _ ê°€ë³€ ê¸¸ì´ ë¬¸ìì—´ ì •ë³´ 
# numeric : ì •ìˆ˜, ì‹¤ìˆ˜ ë“± ìˆ«ì ì •ë³´ (ì˜¤ë¼í´ê³¼ sql ì—ì„œ ì°¨ì´ì ì´ ìˆìŒ_ì£¼ì˜)
# DATE : ë‚ ì§œì™€ ì‹œê° ì •ë³´ 

Class Person:
	pass
# iuë¼ê³  í•˜ëŠ” ë³€ìˆ˜ì˜ ì´ë¦„ì„ ê°€ì§„ Person í´ë˜ìŠ¤ì˜ ì¸ìŠ¤í„´ìŠ¤ë¥¼ ë§Œë“œëŠ” ì½”ë“œëŠ”? 
iu = Person()
# iuì˜ name ì†ì„±ìœ¼ë¡œ ì•„ì´ìœ  ë¼ê³  í•˜ëŠ” ì½”ë“œëŠ”? 
iu.name = 'ì•„ì´ìœ '
```



**(2) ëª¨ë¸ ì„¤ê³„ ë° ë°˜ì˜** 

* í´ë˜ìŠ¤ë¥¼ ìƒì„±í•˜ì—¬ ë‚´ê°€ ì›í•˜ëŠ” DBì˜ êµ¬ì¡°ë¥¼ ë§Œë“ ë‹¤. 
* **í´ë˜ìŠ¤ì˜ ë‚´ìš©**ìœ¼ë¡œ ë°ì´í„°ë² ì´ìŠ¤ì— ë°˜ì˜í•˜ê¸° ìœ„í•œ **ë§ˆì´ê·¸ë ˆì´ì…˜ íŒŒì¼ì„ ìƒì„±**í•œë‹¤. 

```bash
$ python manage.py makemigrations
```

![image-20220824234756197](20220824_db.assets/image-20220824234756197.png)



* DB ì— migrate í•œë‹¤. 

```bash
$ python manage.py migrate
```

![image-20220824235006580](20220824_db.assets/image-20220824235006580.png)



#### ğŸ’¡  Migration _ modelì— ìƒê¸´ ë³€í™”ë¥¼ DBì— ë°˜ì˜í•˜ê¸° ìœ„í•œ ë°©ë²• 

* Migration íŒŒì¼ì„ ë§Œë“¤ì–´ DB **ìŠ¤í‚¤ë§ˆë¥¼ ë°˜ì˜**í•œë‹¤. 

* Migrate : **ë§ˆì´ê·¸ë ˆì´ì…˜ì„ DBì— ë°˜ì˜**



**ğŸ‘‰ ê·¸ëŸ¼ ì–´ë– í•œ ë³€í™”ë“¤ì´ ìˆì£ ?** 

* í´ë˜ìŠ¤ë¥¼ ìƒì„±í•œë‹¤ = í…Œì´ë¸” ìƒì„±

* í•„ë“œ ë³€ê²½ (ìˆ˜ì • or ì‚­ì œ or ì¶”ê°€)  = **í´ë˜ìŠ¤ë¥¼ ìˆ˜ì • = >  makemigrations => Migrate** í•˜ë©´ **DB ê°€ ë°”ë€ë‹¤.** (ALTER ì¿¼ë¦¬ ì—†ì´ë„ ê°€ëŠ¥)

ê²°êµ­, í´ë˜ìŠ¤ë¥¼ ë°”ê¿”ì£¼ë©´ ë‹¤ ì•Œì•„ì„œ ë°”ë€ë‹¤. 



**[ê³„ì† ìƒê°í•˜ê¸°]**

* ë³€ê²½ì‚¬í•­ë“¤ì„ ê²°êµ­ DBì˜ ì°¨ì´ì ì„ ë³´ê³  ë§Œë“¤ì–´ ì£¼ëŠ” ê²ƒ = makemigrations

* ì‹¤ì œ DBì— ë°˜ì˜í•´ì£¼ëŠ” ê²ƒ = migrate



#### â­ Q. ëª¨ë¸ì— ë³€ê²½ ì‚¬í•­ì´ ìƒê¸°ë©´ ë­˜ í•´ì¤˜ì•¼ í•˜ì£ ? = makemigrations, migrate



**ğŸ‘‰ migrate ì‚´í´ë³´ê¸°** 

```python
BEGIN;
--
-- Create model Genre
--
CREATE TABLE "db_genre" (
"id" integer NOT NULL PRIMARY KEY AUTOINCREMENT,
"name" varchar(30) NOT NULL
);
COMMIT;


# íŠ¸ëœì­ì…˜_ ì¿¼ë¦¬ê°€ 1000ì¤„ì„ ë³µë¶™í–ˆëŠ”ë° 892ì¤„ì—ì„œ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆì„ë•Œ ë‹¤ì‹œ ë˜ëŒë¦¬ëŠ” ë°©ë²• ëŒ€ì‹  í•œë²ˆì— ì²˜ë¦¬ í•  ìˆ˜ ìˆëŠ” ë°©ë²•
# ì¤‘ê°„ ì˜¤ë¥˜ê°€ ë°œìƒë˜ë©´ ë¡¤ë°±ì´ ìƒê²¨ì„œ DBì— ë°˜ì˜ì„ ì•ˆí•´ì¤Œ_ ì™„ë²½í•˜ì„¸ ì˜¤ë¥˜ê°€ ì—†ì–´ì•¼ DB ë°˜ì˜ì´ëœë‹¤. 

```



* **íŠ¸ëœì­ì…˜ :  ìª¼ê°¤ ìˆ˜ ì—†ëŠ” ì—…ë¬´ ì²˜ë¦¬ì˜ ìµœì†Œ ë‹¨ìœ„**

> * íŠ¸ëœì­ì…˜ì€ ë°ì´í„°ë² ì´ìŠ¤ ì„œë²„ì— ì—¬ëŸ¬ ê°œì˜ í´ë¼ì´ì–¸íŠ¸ê°€ ë™ì‹œì— ì•¡ì„¸ìŠ¤ í•˜ê±°ë‚˜ ì‘ìš©í”„ë¡œê·¸ë¨ì´ ê°±ì‹ ì„ ì²˜ë¦¬í•˜ëŠ” ê³¼ì •ì—ì„œ ì¤‘ë‹¨ë  ìˆ˜ ìˆëŠ” ê²½ìš° ë“± ë°ì´í„° ë¶€ì •í•©ì„ ë°©ì§€í•˜ê³ ì í•  ë•Œ ì‚¬ìš©í•œë‹¤.
> * íŠ¸ëœì­ì…˜ì€ ì„œë¡œ ê°„ì„­í•˜ì§€ ì•Šì•„ì•¼ í•œë‹¤. ë§Œì•½ ì¿¼ë¦¬ í•˜ë‚˜ê°€ ì‹¤íŒ¨í•˜ë©´, ë°ì´í„°ë² ì´ìŠ¤ ì‹œìŠ¤í…œì€ ì „ì²´ íŠ¸ëœì­ì…˜ ë˜ëŠ” ì‹¤íŒ¨í•œ ì¿¼ë¦¬ë¥¼ ë¡¤ë°± í•œë‹¤. 
> * íŠ¸ëœì­ì…˜ì€ ì»¤ë°‹ì „ì— ì–¸ì œë“ ì§€ ìˆ˜ë™ìœ¼ë¡œ ë¡¤ë°± ë  ìˆ˜ ìˆë‹¤. ê°„ë‹¨í•œ íŠ¸ëœì­ì…˜ì˜ ê²½ìš° ì•„ë˜ ì–‘ì‹ì˜ SQL ì–¸ì–´ë¡œ ë°ì´í„°ë² ì´ìŠ¤ ë‚´ì—ì„œ ì‹¤í–‰ëœë‹¤.

Execute several queries(DBë‚´ ê°±ì‹ ì´ ì•„ì§ ì ìš©ë˜ì§€ ì•ŠëŠ”ë‹¤.)

Commit the transaction(íŠ¸ëœì­ì…˜ì´ ì„±ê³µì ì´ë©°, ê°±ì‹ ì´ ì‹¤ì œ ì ìš©ë¨.)





####  ğŸ’¡ ë°ì´í„°ë² ì´ìŠ¤ ì¡°ì‘ _ Database API

![image-20220825002154598](20220824_db.assets/image-20220825002154598.png)

#### Genre : Class Name / objects : Manager / all() : QuerySet API

---



### âœ” ORM ê¸°ë³¸ì¡°ì‘ 

**(1) CREATE** 

```python
#1. CREATE ë©”ì„œë“œ í™œìš© 
Genre.objects.create(name='ë°œë¼ë“œ')

#2. ì¸ìŠ¤í„´ìŠ¤ ì¡°ì‘ 
genre = Genre()
genre.name = 'ì¸ë””ë°´ë“œ'
genre.save()
```



**(2) READ**

```python
# 1. ì „ì²´ ë°ì´í„° ì¡°íšŒ 
Genre.object.all()

# ê²°ê³¼ : <QuerySet [<Genre: Genre object (1)>, <Genre:Genre object (2)>]>

#2. ì¼ë¶€ ë°ì´í„° ì¡°íšŒ _ get
Genre.objects.get(id=1)

# ê²°ê³¼ : <Genre: Genre object (1)>

#3. ì¼ë¶€ ë°ì´í„° ì¡°íšŒ _ filter
Genre.objects.filter(id=1)

# ê²°ê³¼ : <QuerySet [<Genre: Genre object (1)>]>

```



**(3) UPDATE**

```python
# 1. genre ê°ì²´ í™œìš©
genre = Genre.objects.get(id=1)

# 2. genre ê°ì²´ ì†ì„± ë³€ê²½
genre.name = 'íŠ¸ë¡œíŠ¸â€™

# 3. genre ê°ì²´ ì €ì¥
genre.save()
```



**(4) DELETE**

```python
# 1. genre ê°ì²´ í™œìš©
genre = Genre.objects.get(id=1)

# 2. genre ê°ì²´ ì‚­ì œ
genre.delete()
```



---



### âœ” ìˆ˜ì—…ì˜ˆì œ _ (ì‹¤ìŠµ) 

**â­ë°˜ë“œì‹œ í•´ì¤˜ì•¼í•¨â­**_shell_plus

* ```bash
  $ python manage.py shell_plus
  ```

![image-20220825003528311](20220824_db.assets/image-20220825003528311.png)

**ì™œ name ì„ ë„£ì–´ì¤˜ì•¼ í•˜ë‚˜ìš”?** 

![image-20220825003610137](20220824_db.assets/image-20220825003610137.png)

**nameì´ë¼ëŠ” í•„ë“œê°€ ìˆê¸° ë•Œë¬¸**





---





### í™˜ê²½ì„¤ì •



* ```bash
  $ python -m venv venv
  ```

> venv í™•ì¸ ëœë‹¤ë©´ ë‹¤ìŒ ì„¤ì¹˜ë¥¼ ì´ì–´ë‚˜ê°€ë©´ ëœë‹¤. 

![image-20220824141620939](20220824_db.assets/image-20220824141620939.png)



* ```bash
  $ pip install -r requirements.txt 
  ```

![image-20220824142007531](image-20220824142007531.png)



* ```bash
  # django íŒ¨í‚¤ì§€ ì„¤ì¹˜ í™•ì¸
  $ python manage.py --version
  ```

![image-20220824142602163](20220824_db.assets/image-20220824142602163.png)

> ì„¤ì¹˜ë¥¼ ì œëŒ€ë¡œ í–ˆì§€ë§Œ ìœ„ì™€ê°™ì€ ì—ëŸ¬ê°€ ë°œìƒí•˜ì—¬ ê´€ë ¨ëœ ì˜¤ë¥˜ ì‚¬í•­ì— ëŒ€í•´ ì•Œì•„ë³´ê¸°ë¡œ í•¨ 

> PCì— ëŒ€í•œ ê¶Œí•œ ë¬¸ì œë¡œ ì¸í•´ ì œëŒ€ë¡œ ì„¤ì¹˜ê°€ ì œëŒ€ë¡œ ì•ˆëœê²ƒ ê°™ë‹¤ëŠ” í”¼ë“œë°±ì„ ì‚´í´ë³´ì•˜ë‹¤. 
>
> **ê´€ë¦¬ì ê¶Œí•œ**ìœ¼ë¡œ vscodeë¥¼ ì—´ì–´ë³´ê¸°ë¡œ ê²°ì • 









---





![image-20220824162239736](20220824_db.assets/image-20220824162239736.png)



![image-20220824162341621](20220824_db.assets/image-20220824162341621.png)



![image-20220824162544399](20220824_db.assets/image-20220824162544399.png)









![image-20220824162814299](20220824_db.assets/image-20220824162814299.png)



![image-20220824164705551](20220824_db.assets/image-20220824164705551.png)











![image-20220824164403018](20220824_db.assets/image-20220824164403018.png)